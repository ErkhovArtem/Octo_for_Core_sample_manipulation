I0425 02:34:26.256533 128785362577216 finetune_rgb.py:44] Loading pre-trained model...
Fetching 6 files: 100%|████████████████████████| 6/6 [00:00<00:00, 26078.57it/s]
I0425 02:34:28.515630 128785362577216 octo_module.py:219] repeating task tokens at each timestep to perform cross-modal attention
I0425 02:34:32.211841 128785362577216 checkpointer.py:164] Restoring item from /home/hyperdog/.cache/huggingface/hub/models--rail-berkeley--octo-small-1.5/snapshots/dc9aa3019f764726c770814b27e4ab0fc6e32a58/300000/default.
I0425 02:34:32.624240 128785362577216 checkpointer.py:166] Finished restoring checkpoint from /home/hyperdog/.cache/huggingface/hub/models--rail-berkeley--octo-small-1.5/snapshots/dc9aa3019f764726c770814b27e4ab0fc6e32a58/300000/default.
I0425 02:34:33.764703 128785362577216 finetune_rgb.py:51] Loading finetuning dataset...
I0425 02:34:33.768054 128785362577216 dataset_info.py:578] Load dataset info from /home/hyperdog/tensorflow_datasets/grasping_dataset/1.0.1
I0425 02:34:33.897158 128785362577216 logging_logger.py:49] Constructing tf.data.Dataset grasping_dataset for split all, from /home/hyperdog/tensorflow_datasets/grasping_dataset/1.0.1
I0425 02:34:34.279284 128785362577216 api.py:446] Sampling uniformly across keys: ['language_instruction']
I0425 02:34:34.400574 128785362577216 data_utils.py:139] Computing dataset statistics. This may take awhile, but should only need to happen once for each dataset.
102it [00:00, 142.15it/s]
I0425 02:34:35.464114 128785362577216 logging_logger.py:49] Constructing tf.data.Dataset grasping_dataset for split train[:95%], from /home/hyperdog/tensorflow_datasets/grasping_dataset/1.0.1
I0425 02:34:35.493432 128785362577216 api.py:446] Sampling uniformly across keys: ['language_instruction']
I0425 02:34:48.931080 128785362577216 finetune_rgb.py:117] Updating model for new observation & action space...
I0425 02:34:49.476585 128785362577216 tokenizers.py:124] No task inputs matching image_primary were found. Replacing with zero padding.
I0425 02:34:49.506210 128785362577216 tokenizers.py:124] No task inputs matching image_wrist were found. Replacing with zero padding.
I0425 02:34:49.551784 128785362577216 octo_module.py:219] repeating task tokens at each timestep to perform cross-modal attention
W0425 02:34:49.553533 128785362577216 block_transformer.py:410] Prefix groups:
W0425 02:34:49.553625 128785362577216 block_transformer.py:412] PrefixGroup(name=task_language, shape=(1, 16, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
W0425 02:34:49.553674 128785362577216 block_transformer.py:418] Timestep groups:
W0425 02:34:49.553718 128785362577216 block_transformer.py:420] TimestepGroup(name=obs_primary, shape=(1, 2, 256, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    obs_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
W0425 02:34:49.553760 128785362577216 block_transformer.py:420] TimestepGroup(name=obs_wrist, shape=(1, 2, 64, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    obs_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
W0425 02:34:49.553796 128785362577216 block_transformer.py:420] TimestepGroup(name=obs_proprio, shape=(1, 2, 2, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    obs_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
W0425 02:34:49.553831 128785362577216 block_transformer.py:420] TimestepGroup(name=obs_task_language, shape=(1, 2, 16, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    obs_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
W0425 02:34:49.553867 128785362577216 block_transformer.py:420] TimestepGroup(name=readout_action, shape=(1, 2, 1, 384), attends_to={
    task_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    obs_*: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
    readout_action: <AttentionRule.CAUSAL: 'other.timestep <= self.timestep'>,
})
[3m                                 Attention Mask                                 [0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━┳━━━┳━━┓
┃[1m                                    [0m┃[1m   [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃
┃[1m                                    [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃
┃[1m                                    [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃
┃[1m [0m[1m                                  [0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃[1m [0m[1m…[0m[1m [0m┃[1m  [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━╇━━━╇━━━╇━━━╇━━━╇━━━╇━━━╇━━━╇━━╇━━━╇━━┩
│ task_language (16 tokens)          │ x │ x │ x │ x │ x │ x │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=0 obs_primary (256 tokens)       │   │ x │ x │ x │ x │ x │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=0 obs_wrist (64 tokens)          │   │ x │ x │ x │ x │ x │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=0 obs_proprio (2 tokens)         │   │ x │ x │ x │ x │ x │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=0 obs_task_language (16 tokens)  │   │ x │ x │ x │ x │ x │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=0 readout_action (1 tokens)      │   │   │   │   │   │ x │   │   │  │   │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=1 obs_primary (256 tokens)       │   │   │   │   │   │   │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=1 obs_wrist (64 tokens)          │   │   │   │   │   │   │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=1 obs_proprio (2 tokens)         │   │   │   │   │   │   │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=1 obs_task_language (16 tokens)  │   │   │   │   │   │   │ x │ x │  │ x │  │
├────────────────────────────────────┼───┼───┼───┼───┼───┼───┼───┼───┼──┼───┼──┤
│ t=1 readout_action (1 tokens)      │   │   │   │   │   │   │   │   │  │   │  │
└────────────────────────────────────┴───┴───┴───┴───┴───┴───┴───┴───┴──┴───┴──┘

[3m                               OctoModule Summary                               [0m
┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃[1m [0m[1mpath         [0m[1m [0m┃[1m [0m[1mmodule       [0m[1m [0m┃[1m [0m[1minputs       [0m[1m [0m┃[1m [0m[1moutputs      [0m[1m [0m┃[1m [0m[1mparams      [0m[1m [0m┃
┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│               │ OctoModule    │ -             │ - obs:        │              │
│               │               │ image_primar… │     mask:     │              │
│               │               │ [2muint8[0m[1,2,25… │ [2mbool[0m[1,2,338] │              │
│               │               │   image_wris… │     tokens:   │              │
│               │               │ [2muint8[0m[1,2,12… │ [2mfloat32[0m[1,2,… │              │
│               │               │   pad_mask_d… │   obs_primar… │              │
│               │               │     image_pr… │     mask:     │              │
│               │               │ [2mbool[0m[1,2]     │ [2mbool[0m[1,2,256] │              │
│               │               │     image_wr… │     tokens:   │              │
│               │               │ [2mbool[0m[1,2]     │ [2mfloat32[0m[1,2,… │              │
│               │               │     proprio:  │   obs_propri… │              │
│               │               │ [2mbool[0m[1,2]     │     mask:     │              │
│               │               │     timestep: │ [2mbool[0m[1,2,2]   │              │
│               │               │ [2mbool[0m[1,2]     │     tokens:   │              │
│               │               │   proprio:    │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mfloat32[0m[1,2,… │   obs_task_l… │              │
│               │               │   task_compl… │     mask:     │              │
│               │               │ [2mbool[0m[1,2,4]   │ [2mbool[0m[1,2,16]  │              │
│               │               │   timestep:   │     tokens:   │              │
│               │               │ [2mint32[0m[1,2]    │ [2mfloat32[0m[1,2,… │              │
│               │               │   timestep_p… │   obs_wrist:  │              │
│               │               │ [2mbool[0m[1,2]     │     mask:     │              │
│               │               │ -             │ [2mbool[0m[1,2,64]  │              │
│               │               │ language_ins… │     tokens:   │              │
│               │               │     attentio… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mint32[0m[1,16]   │   readout_ac… │              │
│               │               │     input_id… │     mask:     │              │
│               │               │ [2mint32[0m[1,16]   │ [2mfloat32[0m[1,2,… │              │
│               │               │   pad_mask_d… │     tokens:   │              │
│               │               │     language… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mbool[0m[1]       │   task:       │              │
│               │               │ - [2mbool[0m[1,2]   │     mask:     │              │
│               │               │ - train:      │ [2mbool[0m[1,16]    │              │
│               │               │ False         │     tokens:   │              │
│               │               │   verbose:    │ [2mfloat32[0m[1,16… │              │
│               │               │ True          │   task_langu… │              │
│               │               │               │     mask:     │              │
│               │               │               │ [2mbool[0m[1,16]    │              │
│               │               │               │     tokens:   │              │
│               │               │               │ [2mfloat32[0m[1,16… │              │
│               │               │               │ - action:     │              │
│               │               │               │ [2mfloat32[0m[1,2,… │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ OctoTransfor… │ -             │ obs:          │ obs_primary… │
│               │               │ image_primar… │   mask:       │ [2mfloat32[0m[1,1… │
│               │               │ [2muint8[0m[1,2,25… │ [2mbool[0m[1,2,338] │ obs_proprio… │
│               │               │   image_wris… │   tokens:     │ [2mfloat32[0m[1,1… │
│               │               │ [2muint8[0m[1,2,12… │ [2mfloat32[0m[1,2,… │ obs_wrist_p… │
│               │               │   pad_mask_d… │ obs_primary:  │ [2mfloat32[0m[1,1… │
│               │               │     image_pr… │   mask:       │ readout_act… │
│               │               │ [2mbool[0m[1,2]     │ [2mbool[0m[1,2,256] │ [2mfloat32[0m[1,1… │
│               │               │     image_wr… │   tokens:     │ task_langua… │
│               │               │ [2mbool[0m[1,2]     │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,1… │
│               │               │     proprio:  │ obs_proprio:  │              │
│               │               │ [2mbool[0m[1,2]     │   mask:       │ [1m1,246,464 [0m   │
│               │               │     timestep: │ [2mbool[0m[1,2,2]   │ [1;2m(5.0 MB)[0m     │
│               │               │ [2mbool[0m[1,2]     │   tokens:     │              │
│               │               │   proprio:    │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mfloat32[0m[1,2,… │ obs_task_lan… │              │
│               │               │   task_compl… │   mask:       │              │
│               │               │ [2mbool[0m[1,2,4]   │ [2mbool[0m[1,2,16]  │              │
│               │               │   timestep:   │   tokens:     │              │
│               │               │ [2mint32[0m[1,2]    │ [2mfloat32[0m[1,2,… │              │
│               │               │   timestep_p… │ obs_wrist:    │              │
│               │               │ [2mbool[0m[1,2]     │   mask:       │              │
│               │               │ -             │ [2mbool[0m[1,2,64]  │              │
│               │               │ language_ins… │   tokens:     │              │
│               │               │     attentio… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mint32[0m[1,16]   │ readout_acti… │              │
│               │               │     input_id… │   mask:       │              │
│               │               │ [2mint32[0m[1,16]   │ [2mfloat32[0m[1,2,… │              │
│               │               │   pad_mask_d… │   tokens:     │              │
│               │               │     language… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2mbool[0m[1]       │ task:         │              │
│               │               │ - [2mbool[0m[1,2]   │   mask:       │              │
│               │               │ - train:      │ [2mbool[0m[1,16]    │              │
│               │               │ False         │   tokens:     │              │
│               │               │   verbose:    │ [2mfloat32[0m[1,16… │              │
│               │               │ True          │ task_languag… │              │
│               │               │               │   mask:       │              │
│               │               │               │ [2mbool[0m[1,16]    │              │
│               │               │               │   tokens:     │              │
│               │               │               │ [2mfloat32[0m[1,16… │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ encoder       │ FlaxT5Stack   │ attention_ma… │ attentions:   │              │
│               │               │ [2mint32[0m[1,1]    │ None          │              │
│               │               │ deterministi… │ cross_attent… │              │
│               │               │ True          │ None          │              │
│               │               │ input_ids:    │ hidden_state… │              │
│               │               │ [2mint32[0m[1,1]    │ None          │              │
│               │               │ output_atten… │ last_hidden_… │              │
│               │               │ False         │ [2mfloat32[0m[1,1,… │              │
│               │               │ output_hidde… │ past_key_val… │              │
│               │               │ False         │ None          │              │
│               │               │ return_dict:  │               │              │
│               │               │ True          │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ shared        │ Embed         │ [2mint32[0m[1,1]    │ [2mfloat32[0m[1,1,… │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ encoder/drop… │ Dropout       │ -             │ [2mfloat32[0m[1,1,… │              │
│               │               │ [2mfloat32[0m[1,1,… │               │              │
│               │               │ -             │               │              │
│               │               │ deterministi… │               │              │
│               │               │ True          │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ encoder/block │ FlaxT5BlockC… │ -             │ attentions:   │              │
│               │               │ [2mfloat32[0m[1,1,… │ None          │              │
│               │               │ -             │ cross_attent… │              │
│               │               │ attention_ma… │ None          │              │
│               │               │ [2mint32[0m[1,1]    │ hidden_state… │              │
│               │               │   determinis… │ None          │              │
│               │               │ True          │ last_hidden_… │              │
│               │               │   encoder_at… │ [2mfloat32[0m[1,1,… │              │
│               │               │ None          │ past_key_val… │              │
│               │               │   encoder_hi… │ None          │              │
│               │               │ None          │               │              │
│               │               │   init_cache: │               │              │
│               │               │ False         │               │              │
│               │               │   output_att… │               │              │
│               │               │ False         │               │              │
│               │               │   output_hid… │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ encoder/fina… │ FlaxT5LayerN… │ [2mfloat32[0m[1,1,… │ [2mfloat32[0m[1,1,… │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ LanguageToke… │ -             │ mask:         │ [1m109,628,544 [0m │
│               │               │ image_primar… │ [2mbool[0m[1,16]    │ [1;2m(438.5 MB)[0m   │
│               │               │ [2muint8[0m[1,2,25… │ tokens:       │              │
│               │               │   image_wris… │ [2mfloat32[0m[1,16… │              │
│               │               │ [2muint8[0m[1,2,12… │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     image_pr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     image_wr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     proprio:  │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     timestep: │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │   proprio:    │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   task_compl… │               │              │
│               │               │ [2mbool[0m[1,2,4]   │               │              │
│               │               │   timestep:   │               │              │
│               │               │ [2mint32[0m[1,2]    │               │              │
│               │               │   timestep_p… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │ -             │               │              │
│               │               │ language_ins… │               │              │
│               │               │     attentio… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │     input_id… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     language… │               │              │
│               │               │ [2mbool[0m[1]       │               │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ Dense         │ [2mfloat32[0m[1,16… │ [2mfloat32[0m[1,16… │ bias:        │
│               │               │               │               │ [2mfloat32[0m[384] │
│               │               │               │               │ kernel:      │
│               │               │               │               │ [2mfloat32[0m[768… │
│               │               │               │               │              │
│               │               │               │               │ [1m295,296 [0m[1;2m(1.2[0m │
│               │               │               │               │ [1;2mMB)[0m          │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ ImageTokeniz… │ -             │ mask:         │ [1m1,058,048 [0m   │
│               │               │ image_primar… │ [2mbool[0m[1,2,256] │ [1;2m(4.2 MB)[0m     │
│               │               │ [2muint8[0m[1,2,25… │ tokens:       │              │
│               │               │   image_wris… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2muint8[0m[1,2,12… │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     image_pr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     image_wr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     proprio:  │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     timestep: │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │   proprio:    │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   task_compl… │               │              │
│               │               │ [2mbool[0m[1,2,4]   │               │              │
│               │               │   timestep:   │               │              │
│               │               │ [2mint32[0m[1,2]    │               │              │
│               │               │   timestep_p… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │ -             │               │              │
│               │               │ language_ins… │               │              │
│               │               │     attentio… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │     input_id… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     language… │               │              │
│               │               │ [2mbool[0m[1]       │               │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ Dense         │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │ bias:        │
│               │               │               │               │ [2mfloat32[0m[384] │
│               │               │               │               │ kernel:      │
│               │               │               │               │ [2mfloat32[0m[512… │
│               │               │               │               │              │
│               │               │               │               │ [1m196,992 [0m     │
│               │               │               │               │ [1;2m(788.0 KB)[0m   │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ ImageTokeniz… │ -             │ mask:         │ [1m1,058,048 [0m   │
│               │               │ image_primar… │ [2mbool[0m[1,2,64]  │ [1;2m(4.2 MB)[0m     │
│               │               │ [2muint8[0m[1,2,25… │ tokens:       │              │
│               │               │   image_wris… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2muint8[0m[1,2,12… │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     image_pr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     image_wr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     proprio:  │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     timestep: │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │   proprio:    │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   task_compl… │               │              │
│               │               │ [2mbool[0m[1,2,4]   │               │              │
│               │               │   timestep:   │               │              │
│               │               │ [2mint32[0m[1,2]    │               │              │
│               │               │   timestep_p… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │ -             │               │              │
│               │               │ language_ins… │               │              │
│               │               │     attentio… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │     input_id… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     language… │               │              │
│               │               │ [2mbool[0m[1]       │               │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ Dense         │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │ bias:        │
│               │               │               │               │ [2mfloat32[0m[384] │
│               │               │               │               │ kernel:      │
│               │               │               │               │ [2mfloat32[0m[512… │
│               │               │               │               │              │
│               │               │               │               │ [1m196,992 [0m     │
│               │               │               │               │ [1;2m(788.0 KB)[0m   │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ LowdimObsTok… │ -             │ mask:         │              │
│               │               │ image_primar… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2muint8[0m[1,2,25… │ tokens:       │              │
│               │               │   image_wris… │ [2mfloat32[0m[1,2,… │              │
│               │               │ [2muint8[0m[1,2,12… │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     image_pr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     image_wr… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     proprio:  │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │     timestep: │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │   proprio:    │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   task_compl… │               │              │
│               │               │ [2mbool[0m[1,2,4]   │               │              │
│               │               │   timestep:   │               │              │
│               │               │ [2mint32[0m[1,2]    │               │              │
│               │               │   timestep_p… │               │              │
│               │               │ [2mbool[0m[1,2]     │               │              │
│               │               │ -             │               │              │
│               │               │ language_ins… │               │              │
│               │               │     attentio… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │     input_id… │               │              │
│               │               │ [2mint32[0m[1,16]   │               │              │
│               │               │   pad_mask_d… │               │              │
│               │               │     language… │               │              │
│               │               │ [2mbool[0m[1]       │               │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ Dense         │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │ bias:        │
│               │               │               │               │ [2mfloat32[0m[384] │
│               │               │               │               │ kernel:      │
│               │               │               │               │ [2mfloat32[0m[256… │
│               │               │               │               │              │
│               │               │               │               │ [1m98,688 [0m      │
│               │               │               │               │ [1;2m(394.8 KB)[0m   │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ octo_transfo… │ BlockTransfo… │ - -           │ - -           │ [1m21,294,336 [0m  │
│               │               │ attention_ru… │ attention_ru… │ [1;2m(85.2 MB)[0m    │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mbool[0m[1,16]    │ [2mbool[0m[1,16]    │              │
│               │               │     name:     │     name:     │              │
│               │               │ task_language │ task_language │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,16… │ [2mfloat32[0m[1,16… │              │
│               │               │ - -           │ - -           │              │
│               │               │ attention_ru… │ attention_ru… │              │
│               │               │       obs_*:  │       obs_*:  │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mbool[0m[1,2,256] │ [2mbool[0m[1,2,256] │              │
│               │               │     name:     │     name:     │              │
│               │               │ obs_primary   │ obs_primary   │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │   -           │   -           │              │
│               │               │ attention_ru… │ attention_ru… │              │
│               │               │       obs_*:  │       obs_*:  │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mbool[0m[1,2,64]  │ [2mbool[0m[1,2,64]  │              │
│               │               │     name:     │     name:     │              │
│               │               │ obs_wrist     │ obs_wrist     │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │   -           │   -           │              │
│               │               │ attention_ru… │ attention_ru… │              │
│               │               │       obs_*:  │       obs_*:  │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mbool[0m[1,2,2]   │ [2mbool[0m[1,2,2]   │              │
│               │               │     name:     │     name:     │              │
│               │               │ obs_proprio   │ obs_proprio   │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │   -           │   -           │              │
│               │               │ attention_ru… │ attention_ru… │              │
│               │               │       obs_*:  │       obs_*:  │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mbool[0m[1,2,16]  │ [2mbool[0m[1,2,16]  │              │
│               │               │     name:     │     name:     │              │
│               │               │ obs_task_lan… │ obs_task_lan… │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │   -           │   -           │              │
│               │               │ attention_ru… │ attention_ru… │              │
│               │               │       obs_*:  │       obs_*:  │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       readou… │       readou… │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │       task_*: │       task_*: │              │
│               │               │ <AttentionRu… │ <AttentionRu… │              │
│               │               │ other.timest… │ other.timest… │              │
│               │               │ <=            │ <=            │              │
│               │               │ self.timeste… │ self.timeste… │              │
│               │               │     mask:     │     mask:     │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │     name:     │     name:     │              │
│               │               │ readout_acti… │ readout_acti… │              │
│               │               │     tokens:   │     tokens:   │              │
│               │               │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
│               │               │   verbose:    │               │              │
│               │               │ True          │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ heads_action  │ L1ActionHead  │ - obs:        │ [2mfloat32[0m[1,2,… │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,2,338] │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   obs_primar… │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,2,256] │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   obs_propri… │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,2,2]   │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   obs_task_l… │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,2,16]  │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   obs_wrist:  │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,2,64]  │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   readout_ac… │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │              │
│               │               │   task:       │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,16]    │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,16… │               │              │
│               │               │   task_langu… │               │              │
│               │               │     mask:     │               │              │
│               │               │ [2mbool[0m[1,16]    │               │              │
│               │               │     tokens:   │               │              │
│               │               │ [2mfloat32[0m[1,16… │               │              │
│               │               │ - train:      │               │              │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ heads_action… │ MAPHead       │ - mask:       │ [2mfloat32[0m[1,2,… │ probe:       │
│               │               │ [2mfloat32[0m[1,2,… │               │ [2mfloat32[0m[1,1… │
│               │               │   tokens:     │               │              │
│               │               │ [2mfloat32[0m[1,2,… │               │ [1m1,774,080 [0m   │
│               │               │ - train:      │               │ [1;2m(7.1 MB)[0m     │
│               │               │ False         │               │              │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│ heads_action… │ Dense         │ [2mfloat32[0m[1,2,… │ [2mfloat32[0m[1,2,… │ bias:        │
│               │               │               │               │ [2mfloat32[0m[28]  │
│               │               │               │               │ kernel:      │
│               │               │               │               │ [2mfloat32[0m[384… │
│               │               │               │               │              │
│               │               │               │               │ [1m10,780 [0m[1;2m(43.1[0m │
│               │               │               │               │ [1;2mKB)[0m          │
├───────────────┼───────────────┼───────────────┼───────────────┼──────────────┤
│[1m [0m[1m             [0m[1m [0m│[1m [0m[1m             [0m[1m [0m│[1m [0m[1m             [0m[1m [0m│[1m [0m[1m        Total[0m[1m [0m│[1m [0m[1m136,858,268 [0m[1m [0m│
│[1m               [0m│[1m               [0m│[1m               [0m│[1m               [0m│[1m [0m[1;2m(547.4 MB)[0m[1m  [0m[1m [0m│
└───────────────┴───────────────┴───────────────┴───────────────┴──────────────┘
[1m                                                                                [0m
[1m                    Total Parameters: 136,858,268 [0m[1;2m(547.4 MB)[0m[1m                    [0m
I0425 02:34:53.761193 128785362577216 tokenizers.py:124] No task inputs matching image_primary were found. Replacing with zero padding.
I0425 02:34:53.789317 128785362577216 tokenizers.py:124] No task inputs matching image_wrist were found. Replacing with zero padding.
I0425 02:34:53.821346 128785362577216 octo_module.py:219] repeating task tokens at each timestep to perform cross-modal attention
I0425 02:34:58.075630 128785362577216 compiler.py:323] Persistent compilation cache hit for 'jit__init'
I0425 02:34:58.098244 128785362577216 train_utils.py:405] ########## Parameters skipped during model loading: ##########
I0425 02:34:58.098402 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.LayerNorm_0.bias
I0425 02:34:58.098444 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.LayerNorm_0.scale
I0425 02:34:58.098476 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MlpBlock_0.Dense_0.bias
I0425 02:34:58.098505 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MlpBlock_0.Dense_0.kernel
I0425 02:34:58.098536 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MlpBlock_0.Dense_1.bias
I0425 02:34:58.098561 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MlpBlock_0.Dense_1.kernel
I0425 02:34:58.098586 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.key.bias
I0425 02:34:58.098613 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.key.kernel
I0425 02:34:58.098638 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.out.bias
I0425 02:34:58.098664 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.out.kernel
I0425 02:34:58.098688 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.query.bias
I0425 02:34:58.098714 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.query.kernel
I0425 02:34:58.098740 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.value.bias
I0425 02:34:58.098765 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.MultiHeadDotProductAttention_0.value.kernel
I0425 02:34:58.098789 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.map_head.probe
I0425 02:34:58.098814 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.mean_proj.bias
I0425 02:34:58.098838 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: heads_action.mean_proj.kernel
I0425 02:34:58.098863 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: octo_transformer.obs_proprio_pos_embedding
I0425 02:34:58.098887 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: octo_transformer.obs_proprio_projection.bias
I0425 02:34:58.098911 128785362577216 train_utils.py:407] Param missing in pre-trained model, skipping: octo_transformer.obs_proprio_projection.kernel
I0425 02:34:58.099623 128785362577216 train_utils.py:250] Freezing parameters that include the following keys: ['*hf_model*'].
I0425 02:34:58.101372 128785362577216 train_utils.py:286] Num trainable params: 27,229,724.
I0425 02:34:58.101454 128785362577216 train_utils.py:287] Num frozen params: 109,628,544.
I0425 02:34:58.101490 128785362577216 train_utils.py:288] To see a detailed list of frozen params, set logging level to DEBUG.
I0425 02:34:58.750614 128785362577216 finetune_rgb.py:175] Starting finetuning...
  0%|                                                 | 0/50000 [00:00<?, ?it/s]I0425 02:34:59.366099 128785362577216 tokenizers.py:124] No task inputs matching image_primary were found. Replacing with zero padding.
I0425 02:34:59.460555 128785362577216 tokenizers.py:124] No task inputs matching image_wrist were found. Replacing with zero padding.
I0425 02:34:59.532906 128785362577216 octo_module.py:219] repeating task tokens at each timestep to perform cross-modal attention
/home/hyperdog/anaconda3/envs/octo/lib/python3.10/site-packages/jax/_src/compiler.py:365: UserWarning: Error reading persistent compilation cache entry for 'jit_train_step': XlaRuntimeError: INTERNAL: RET_CHECK failure (external/xla/xla/hlo/ir/hlo_module.cc:511) !ContainsKey(instruction_names, instruction->name()) Instruction name is not unique: constant_4820
  warnings.warn(
I0425 02:35:18.914767 128785362577216 compilation_cache.py:101] Writing jit_train_step to persistent compilation cache with key jit_train_step-b7a8aa2df6806ee4fb5b9505ffced0f0c78384d0cba9d8c456b43435da9ccc1f.
 50%|████████████████▍                | 24999/50000 [1:23:55<1:18:38,  5.30it/s]I0425 03:58:54.757312 128785362577216 checkpointer.py:134] Saving item to /home/hyperdog/octo/checkpoints/shampoo_100/24999.orbax-checkpoint-tmp-1745542734712655/default.
I0425 03:58:55.664607 128785362577216 utils.py:529] Renaming /home/hyperdog/octo/checkpoints/shampoo_100/24999.orbax-checkpoint-tmp-1745542734712655/default.orbax-checkpoint-tmp-1745542734757499 to /home/hyperdog/octo/checkpoints/shampoo_100/24999.orbax-checkpoint-tmp-1745542734712655/default
I0425 03:58:55.664847 128785362577216 utils.py:573] Finished saving checkpoint to `/home/hyperdog/octo/checkpoints/shampoo_100/24999.orbax-checkpoint-tmp-1745542734712655/default`.
I0425 03:58:55.666412 128785362577216 utils.py:529] Renaming /home/hyperdog/octo/checkpoints/shampoo_100/24999.orbax-checkpoint-tmp-1745542734712655 to /home/hyperdog/octo/checkpoints/shampoo_100/24999
100%|██████████████████████████████████▉| 49999/50000 [2:46:56<00:00,  5.31it/s]I0425 05:21:55.651727 128785362577216 checkpointer.py:134] Saving item to /home/hyperdog/octo/checkpoints/shampoo_100/49999.orbax-checkpoint-tmp-1745547715650045/default.
I0425 05:21:56.535325 128785362577216 utils.py:529] Renaming /home/hyperdog/octo/checkpoints/shampoo_100/49999.orbax-checkpoint-tmp-1745547715650045/default.orbax-checkpoint-tmp-1745547715651890 to /home/hyperdog/octo/checkpoints/shampoo_100/49999.orbax-checkpoint-tmp-1745547715650045/default
I0425 05:21:56.535573 128785362577216 utils.py:573] Finished saving checkpoint to `/home/hyperdog/octo/checkpoints/shampoo_100/49999.orbax-checkpoint-tmp-1745547715650045/default`.
I0425 05:21:56.536719 128785362577216 utils.py:529] Renaming /home/hyperdog/octo/checkpoints/shampoo_100/49999.orbax-checkpoint-tmp-1745547715650045 to /home/hyperdog/octo/checkpoints/shampoo_100/49999
100%|███████████████████████████████████| 50000/50000 [2:46:57<00:00,  4.99it/s]
